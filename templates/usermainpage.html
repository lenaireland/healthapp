{% extends 'base.html' %}

{% block title %}Health Tracker{% endblock %}

{% block content %}

  <a href="/settings">Settings</a><br>
  <a href="/logout">Logout</a>

  {% if user.fname %}

    <h2>Welcome {{user.fname}}</h2>
  {% else %}
    <h2>Welcome</h2>
  {% endif %}

  <p>
  {% if date.date()==today.date() %}
    <a href="/user/{{ session['userid'] }}/{{ prev_date.date() }}">
      Yesterday ({{ prev_date.date() }})</a>
    <br><b>Today ({{ date.date() }})</b><br> 

  {% elif date.date() < today.date() %}
    <a href="/user/{{ session['userid'] }}/{{ prev_date.date() }}">
      {{ prev_date.date() }}</a>
    <br><b>{{ date.date() }}</b><br>
    <a href="/user/{{ session['userid'] }}/{{ next_date.date() }}">
      {{next_date.date()}}</a> 

  {% else %}
    You can't track future days!
    <a href="/user/{{ session['userid'] }}/{{ today.date() }}">
    Today ({{ today.date() }})</a>
  {% endif %}
  </p>

  <p>
    <a href="/query">
      Data Query
    </a>
  </p>

  <p>
    <a href="/add-tracking">
      Add new condition/item to track
    </a>
  </p>

  <p>
    <a href="/stop-tracking">
      Stop tracking condition/item
    </a>
  </p>

  {% for condition in info %}
    <h2>{{condition}}</h2>
    {% for symptom in info[condition]['symptoms'] %}

      <p>{{symptom.Symptom.symptom_name}}
        <button name="symptombutton"
          id="usersymptom {{symptom.Symptom.symptom_id_pk}} {{ date.date() }}">
          -
        </button>
      </p>

    {% endfor %}
    -----------

    {% for item in info[condition]['value_types'] %}
      <p>
        {% if item.ValueType.value_name == "AQI" %}
          <form name="valueform" data-toggle="modal" data-target="#exampleModal"
            id="uservalue {{item.ValueType.value_id_pk}} {{ date.date() }}">
          {{item.ValueType.value_name}}
            <input type="text" name="value">
            <input type="submit" name="submit" class="btn btn-primary">
          </form>
        {% else %}
          <form name="valueform" 
            id="uservalue {{item.ValueType.value_id_pk}} {{ date.date() }}">
          {{item.ValueType.value_name}}
            <input type="text" name="value">
            <input type="submit" name="submit" class="btn btn-primary">
          </form>
        {% endif %}        
      </p> 
    {% endfor %}
    -----------

    {% for item in info[condition]['count_types'] %}
      <p>
        <form name="countform" 
          id="usercount {{item.CountType.count_id_pk}} {{ date.date() }}">
        {{item.CountType.count_name}}
          <input type="number" name="count" min="0">
          <input type="submit" name="submit" class="btn btn-primary">
        </form>
      </p> 
    {% endfor %}
    -----------

  {% endfor %}

  <p>Daily Log
    <form name="dailylog" id="userlog {{ date.date() }}">
      <textarea name="dailylogtext"></textarea>
      <input type="submit" name="submit" class="btn btn-primary">
    </form>
  </p>

<!-- Modal -->
<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Get AirNOW AQI Data</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        Do you want to use your default zipcode to get the Air Quality Index or enter another zipcode (US ONLY)?
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary" id="default-zip">Default Zipcode</button>
      </div>
      <div class="modal-footer">
        <form name="zip-form">
        Enter 5-digit zip
          <input type="text" name="newzip">
          <input type="submit" name="submit" class="btn btn-primary">
        </form>
      </div>
    </div>
  </div>
</div>



  <script src="/static/js/symptoms-update.js"></script>
  <script src="/static/js/value-items-update.js"></script>
  <script src="/static/js/count-items-update.js"></script>
  <script src="/static/js/log-update.js"></script>

{% endblock %}